init_minelaying_countries_array = {
  clear_array = minelaying_countries

  add_to_array = { minelaying_countries = AST }
  add_to_array = { minelaying_countries = BRA }
  add_to_array = { minelaying_countries = DEN }
  add_to_array = { minelaying_countries = ENG }
  add_to_array = { minelaying_countries = FIN }
  add_to_array = { minelaying_countries = FRA }
  add_to_array = { minelaying_countries = GER }
  add_to_array = { minelaying_countries = GRE }
  add_to_array = { minelaying_countries = HOL }
  add_to_array = { minelaying_countries = ITA }
  add_to_array = { minelaying_countries = JAP }
  add_to_array = { minelaying_countries = NOR }
  add_to_array = { minelaying_countries = POL }
  add_to_array = { minelaying_countries = ROM }
  add_to_array = { minelaying_countries = SOV }
  add_to_array = { minelaying_countries = SPR }
  add_to_array = { minelaying_countries = USA }
  add_to_array = { minelaying_countries = YUG }
  add_to_array = { minelaying_countries = CAN }
  add_to_array = { minelaying_countries = CHI }
  add_to_array = { minelaying_countries = MEX }
  add_to_array = { minelaying_countries = SIA }
}

init_united_front_countries_array = {
  clear_array = united_front_countries

  add_to_array = { united_front_countries = CHI }
  add_to_array = { united_front_countries = PRC }
  add_to_array = { united_front_countries = YUN }
  add_to_array = { united_front_countries = SIK }
  add_to_array = { united_front_countries = XSM }
  add_to_array = { united_front_countries = GXC }
  add_to_array = { united_front_countries = SHX }
}

init_uk_dominions_array = {
  clear_array = uk_dominions

  add_to_array = { uk_dominions = CAN }
  add_to_array = { uk_dominions = RAJ }
  add_to_array = { uk_dominions = SAF }
  add_to_array = { uk_dominions = AST }
  add_to_array = { uk_dominions = NZL }
}

ensure_united_front_exists = {
  init_united_front_countries_array = yes

  if = {
    limit = {
      NOT = { CHI = { is_faction_leader = yes } }
    }

    CHI = {
      set_rule = { can_create_factions = yes }
      create_faction = chinese_united_front
    }

  }

  for_each_scope_loop = {
    array = united_front_countries

    if = {
      limit = {
        NOT = {
          OR = {
            is_faction_leader = yes
            is_in_faction_with = CHI
          }
        }
      }

      CHI = {
        # THIS is CHI
        # PREV is loop scope
        add_to_faction = PREV
      }

      if = {
  			limit = {
  				is_literally_china = yes
  				has_DLC = "Waking the Tiger"
  			}
  			CHI_set_ally_strat_on_current_leader = yes #sets ally strategy to current Chinese leader
  		}

      add_ai_strategy = {
				type = alliance
				id = "CHI"
				value = 200
			}
    }
  }

  set_global_flag = CHI_unite
}
